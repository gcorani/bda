---
title: "Think Bayesian"
author: "Giorgio Corani  - (IDSIA, SUPSI)"
date: ' Bayesian Data analysis and Probabilistic Programming'
output:
  beamer_presentation:
    latex_engine: xelatex
    fig_width: 6
    fig_height: 3
    highlight: tango
    theme: metropolis
    includes:
      in_header: header.tex
fontsize: 13pt
---

# Credits

* Chap. 1 of *Bayes Rules! An Introduction to Applied Bayesian Modeling*
  * https://www.bayesrulesbook.com/chapter-1.html


# The big picture

* We continuously update our knowledge about the world as we accumulate  experience or collect data. 

\bigskip


* The Bayesian approach rigorously  models the knowledge-building process, in which you update your knowledge on the basis of new  data.

\bigskip

* Knowledge (or ignorance) is expressed by means of a probability distribution on the variables of interest.


# Changing opinion based on experience


* Suppose there’s a new restaurant with 5-star online rating.

\bigskip

* Prior to enter the restaurant, you expect that it will be  delicious.

\bigskip

* On your first visit, the pasta is poorly cooked.

\bigskip

* You weigh the high online rating against  your poor meal (which might have just been a fluke), and you update your opinion knowledge: this is a medium, not an excellent restaurant.

# Changing opinion based on experience

*   In your second meal at the restaurant you’re pleased with your dinner and increase your personal restaurant’s rating to good.

\bigskip

* You continue to visit the restaurant, collecting edible data and updating your knowledge each time.

\bigskip

* After enough visits, you have your own informed opinion.

# Building knowledge

```{r, echo=FALSE, out.width = '80%'}
knitr::include_graphics("restaurant_diagram.png")
```



# Building knowledge

* An environmental scientist analyses of the human role in climate change.

\bigskip

* He carries a degree of incoming or prior information based on previous research and experience.

\bigskip

* In light of this information he interprets new data, considering both to develop an updated understanding (posterior information).

\bigskip

* He continues to refine this information as he gathers new evidence.

# Building knowledge as a Bayesian process

```{r, echo=FALSE, out.width = '80%'}
knitr::include_graphics("bayes_diagram.png")
```

# Your turn

 * Think of a recent situation in which you changed your mind. 
 
 \bigskip
 
 * As with the Italian restaurant example, make a diagram that includes your prior information, your new data that helped you change your mind, and your posterior conclusion. 

#   Bayesian interpretation of probability

* The probability of a coin landing  Heads is 0.5. 
  * How do you interpret this probability?

\bigskip

  * If I flip this coin over and over, roughly 50% will be Heads (*frequentist* interpretation).

  \bigskip

  *  Heads and Tails are equally plausible in the next flip (*Bayesian* interpretation).

# Bayesian vs frequentist probability

 * According to both Bayesian and frequentist probability,  the probability of observing Heads on a fair coin flip is 1/2. The difference is in their interpretation:

\bigskip
  * frequentist:  probability is the long-run relative frequency of a repeatable event.

\bigskip

  * Bayesian:  probability measures the relative plausibility of an event.


  
# Bayesian vs frequentist intepretation

* An election is coming up and a pollster claims that candidate A has a 0.9 probability of winning. How do you interpret this probability?

  \bigskip

  * If we observe the election over and over, candidate A will win roughly 90% of the time.

  \bigskip

  * Candidate A is much more likely to win than to lose.

\bigskip

* This event is non-repeatable and frequentist probability does not really apply.

# Your turn

*  Identify a topic that you know about (e.g., a sport, a school subject, music).

\bigskip

*  Formulata a probabilistic hypothesis about this subject (e.g.: with probability 80% rider X will become world champion)

\bigskip

*  Discuss whether this probability  is better interpreted by the  frequentist or the  Bayesian  interpretation.



# Testing hypothesis: frequentist vs Bayesian

* Imagine that you tested positive for a disease; you can make a single  question to the doctor.

\bigskip

  1) what’s the probability that I  have the disease?

  \bigskip

  2) if I do not have the disease, what’s the chance that I would’ve gotten the positive result?

# Asking questions

* Bayesian analysis would answer the first question, by  assessing the probability of the hypothesis $H$ given  the data $D$, $P(H|D)$.

\bigskip

* Frequentist analysis  answers the second question: the probability of the  data $D$ given of an assumed hypothesis $H$ ($P(D|H)$).

# Probability of having the disease, given a positive test

|  |  | test pos | test neg | total |
|---|---|---:|---:|---:|
| disease |  | 3 | 1 | 4 |
| no disease |  | 9 | 87 | 96 |
| total |  | 12 | 88 | 100 |

* Only 3 of the 12 people that tested positive have the disease; there’s only a 25% chance that you have the disease. 

\bigskip

* This is the Bayesian answer: it measures the probability of a hypothesis, given the observed data.

# Probability of testing positive, given that I do not have the disease

|  |  | test pos | test neg | total |
|---|---|---:|---:|---:|
| disease |  | 3 | 1 | 4 |
| no disease |  | 9 | 87 | 96 |
| total |  | 12 | 88 | 100 |

* From the frequentist standpoint, since disease status isn’t repeatable, the probability you have the disease is either 1 or 0 – you have it or you don’t. 

\bigskip

* Medical testing is repeatable. You can get tested for the disease over and over and over. 

\bigskip

* Thus, a frequentist analysis  asks: If I don’t actually have the disease, what’s the chance that I would’ve tested positive?

# Probability of testing positive, given that I do not have the disease

*  Since only 9 of the 96 people without the disease tested positive, there’s a roughly 10% (9/96) chance that you would’ve tested positive  if you didn’t have the disease. 

\bigskip

* This computation is similar in spirit to the p-value of traditional hypothesis testing.
