#
## Regioni di rifiuto

# Test a due code
  * $H_0: \mu_1 = \mu_2$
  * $H_1: \mu_1 \neq \mu_2$
    * Regione di rifiuto: $t_0 < t_{n_1+n_2-2,\alpha/2}$ e $t_0 > t_{n_1+n_2-2,1-\alpha/2}$
    * Ogni coda contiene probabilità $\alpha/2$

\bigskip

```{r echo=FALSE, out.width="80%", fig.align='center', warning=FALSE}
library(ggplot2)
library(ggthemes)
library(latex2exp)

tDistribution <- data.frame(
  x = seq(-4,4, by = 0.01),
  y = dt(seq(-4,4, by = 0.01), df=13)
)

critical <- qt(.975, df=13)

shadeRight <- rbind(c(critical,0), subset(tDistribution, x > critical))
shadeLeft <-  rbind(c(-critical,0), subset(tDistribution, x < -critical))


ggplot(tDistribution, aes(x,y)) +
  geom_line() +
  geom_polygon(data = shadeRight, aes(x=x, y=y, fill="red")) +
  geom_polygon(data = shadeLeft, aes(x=x, y=y, fill="red")) +
  #remove legend
  guides(fill="none") +
  theme_economist() +
  theme(text = element_text(size = 16)) +

  #remove labels
  ylab("") + xlab("") +

  #remove y ticks
  theme(axis.ticks.y = element_blank(),
        axis.text.y = element_blank()) +

  scale_x_continuous(breaks=c(-critical,0,critical),
                     labels = c(TeX(r'($t_{\alpha/2,n_1+n_2-2}$)'),0,TeX(r'($t_{1-\alpha/2,n_1+n_2-2}$)'))) #+

```





# Test con coda destra

  * $H_0: \mu_1 \leq \mu_2$
  * $H_1: \mu_1 > \mu_2$
    * Valori *positivi* della statistica tendono a supportare $H_1$
    * Regione di rifiuto: $t_0 > t_{n_1+n_2-2,\alpha}$ (contiene probabilità $\alpha$).


```{r echo=FALSE, out.width="80%", fig.align='center', warning=FALSE}
library(ggplot2)
library(ggthemes)
library(latex2exp)

tDistribution <- data.frame(
  x = seq(-4,4, by = 0.01),
  y = dt(seq(-4,4, by = 0.01), df=13)
)

critical <- qt(.95, df=13)

shadeRight <- rbind(c(critical,0), subset(tDistribution, x > critical))


ggplot(tDistribution, aes(x,y)) +
  geom_line() +
  geom_polygon(data = shadeRight, aes(x=x, y=y, fill="red")) +
  #remove legend
  guides(fill="none") +
  theme_economist() +
  theme(text = element_text(size = 16)) +

  #remove labels
  ylab("") + xlab("") +

  #remove y ticks
  theme(axis.ticks.y = element_blank(),
        axis.text.y = element_blank()) +

  scale_x_continuous(breaks=c(0,critical),
                     labels = c(0,TeX(r'($t_{1-\alpha,n_1+n_2-2}$)'))) 

```







# Test a una coda (sinistra)
  * $H_0: \mu_1 \geq \mu_2$
  * $H_1: \mu_1 < \mu_2$
    * Valori *negativi* della statistica supportano $H_1$
    * Regione di rifiuto: $t_0 < -t_{n_1+n_2-2,\alpha}$ (contiene probabilità $\alpha$)


```{r echo=FALSE, out.width="80%", fig.align='center', warning=FALSE}
library(ggplot2)
library(ggthemes)
library(latex2exp)

tDistribution <- data.frame(
  x = seq(-4,4, by = 0.01),
  y = dt(seq(-4,4, by = 0.01), df=13)
)

critical <- qt(.05, df=13)

shadeLeft <-  rbind(c(critical,0), subset(tDistribution, x < critical))


ggplot(tDistribution, aes(x,y)) +
  geom_line() +
  geom_polygon(data = shadeLeft, aes(x=x, y=y, fill="red")) +
  #remove legend
  guides(fill="none") +
  theme_economist() +
  theme(text = element_text(size = 16)) +

  #remove labels
  ylab("") + xlab("") +

  #remove y ticks
  theme(axis.ticks.y = element_blank(),
        axis.text.y = element_blank()) +

  scale_x_continuous(breaks=c(critical, 0),
                     labels = c(TeX(r'($t_{\alpha,n_1+n_2-2}$)'), 0))

```




